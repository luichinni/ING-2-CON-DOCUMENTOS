CREATE TABLE Usuarios (
    username varchar (50) PRIMARY KEY,
    clave varchar (50),
    nombre varchar (255),
    apellido varchar (255),
    dni int(8),
    mail varchar (255),
    telefono int NULL,
    rol ENUM('user', 'volunt', 'admin')
)

CREATE TABLE Categoria (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(255)
);

CREATE TABLE Publicacion (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(255),
    descripcion TEXT,
    user varchar (50),
    categoria_id INT,
    estado VARCHAR(50),
    FOREIGN KEY (user) REFERENCES Usuarios(username),
    FOREIGN KEY (categoria_id) REFERENCES Categoria(id)
);

CREATE TABLE Centros (
    id INT AUTO_INCREMENT PRIMARY KEY,
    Nombre varchar(255),
    direccion varchar (255),
    hora_abre TIME,
    hora_cierra TIME
 )

CREATE TABLE publi_centro (
    publicacion int,
    centro int,
    PRIMARY KEY (publicacion, centro),
    FOREIGN KEY (publicacion) REFERENCES Publicacion (id),
    FOREIGN KEY (centro) REFERENCES Centros (id)
)

CREATE TABLE imagen (
    id INT AUTO_INCREMENT PRIMARY KEY,
    tipo_imagen varchar(5),
    archivo varchar(255),
    publicacion int,
    FOREIGN KEY (publicacion) REFERENCES publicacion (id)
)

CREATE TABLE centro_volun (
    centro int,
    voluntario varchar(50),
    PRIMARY KEY (centro, voluntario),
    FOREIGN KEY (centro) REFERENCES centros(id),
    FOREIGN KEY (voluntario) REFERENCES usuarios (username)
)

CREATE TABLE SesionActiva (
    user varchar(50) PRIMARY KEY,
    token varchar(255),
    ultimaAccion timestamp,
    fechaInicio timestamp DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user) REFERENCES Usuarios(username)
)

CREATE TABLE Comentario (
    id INT AUTO_INCREMENT PRIMARY KEY,
    publicacion int,
    user varchar (50),
    respondeA int NULL,
    FOREIGN KEY (user) REFERENCES Usuarios(username),
    FOREIGN KEY (respondeA) REFERENCES Comentario(id)
)

CREATE TABLE Intercambio (
    id INT AUTO_INCREMENT PRIMARY KEY,
    voluntario varchar (50),
    publicacion1 int,
    publicacion2 int,
    horario TIME,
    estado ENUM('pendiente','cancelado','rechazado','aceptado','concretado'),
    descripcion TEXT,
    donacion BOOLEAN,
    FOREIGN KEY (voluntario) REFERENCES Usuarios(username),
    FOREIGN KEY (publicacion1) REFERENCES Publicacion(id),
    FOREIGN KEY (publicacion2) REFERENCES Publicacion(id)
)

CREATE TABLE Publi_Inter (
    publicacion int,
    intercambio int,
    FOREIGN KEY (publicacion) REFERENCES Publicacion(id),
    FOREIGN KEY (intercambio) REFERENCES Intercambio(id),
    PRIMARY KEY (publicacion, intercambio)
)

CREATE TABLE Notificacion (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user varchar(50),
    texto TEXT,
    FOREIGN KEY (user) REFERENCES Usuarios(username)
)